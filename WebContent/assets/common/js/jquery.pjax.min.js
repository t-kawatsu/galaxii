(function(f){function i(x,y,z){var A=this;return this.on("click.pjax",x,function(B){z=q(y,z);if(!z.container){z.container=f(this).attr("data-pjax")||A}j(B,z)})}function j(A,x,y){y=q(x,y);var z=A.currentTarget;if(z.tagName.toUpperCase()!=="A"){throw"$.fn.pjax or $.pjax.click requires an anchor element"}if(A.which>1||A.metaKey||A.ctrlKey){return}if(location.protocol!==z.protocol||location.host!==z.host){return}if(z.hash&&z.href.replace(z.hash,"")===location.href.replace(location.hash,"")){return}if(z.href===location.href+"#"){return}var B={url:z.href,container:f(z).attr("data-pjax"),target:z,fragment:null};v(f.extend({},B,y));A.preventDefault()}function o(A,x,y){y=q(x,y);var z=A.currentTarget;if(z.tagName.toUpperCase()!=="FORM"){throw"$.pjax.submit requires a form element"}var B={type:z.method,url:z.action,data:f(z).serializeArray(),container:f(z).attr("data-pjax"),target:z,fragment:null,timeout:0};v(f.extend({},B,y));A.preventDefault()}function v(x){x=f.extend(true,{},f.ajaxSettings,v.defaults,x);if(f.isFunction(x.url)){x.url=x.url()}var C=x.target;var B=n(x.url).hash;var y=x.context=p(x.container);if(!x.data){x.data={}}x.data._pjax=y.selector;function A(F,E){var G=f.Event(F,{relatedTarget:C});y.trigger(G,E);return !G.isDefaultPrevented()}var z;x.beforeSend=function(G,F){if(F.type!=="GET"){F.timeout=0}if(F.timeout>0){z=setTimeout(function(){if(A("pjax:timeout",[G,x])){G.abort("timeout")}},F.timeout);F.timeout=0}G.setRequestHeader("X-PJAX","true");G.setRequestHeader("X-PJAX-Container",y.selector);var E;if(!A("pjax:beforeSend",[G,F])){return false}x.requestUrl=n(F.url).href};x.complete=function(E,F){if(z){clearTimeout(z)}A("pjax:complete",[E,F,x]);A("pjax:end",[E,x])};x.error=function(H,I,F){var E=t("",H,x);var G=A("pjax:error",[H,I,F,x]);if(I!=="abort"&&G){u(E.url)}};x.success=function(H,F,J){var E=t(H,J,x);if(!E.contents){u(E.url);return}v.state={id:x.id||k(),url:E.url,title:E.title,container:y.selector,fragment:x.fragment,timeout:x.timeout};if(x.push||x.replace){window.history.replaceState(v.state,E.title,E.url)}if(E.title){document.title=E.title}y.html(E.contents);if(typeof x.scrollTo==="number"){f(window).scrollTop(x.scrollTo)}if((x.replace||x.push)&&window._gaq){_gaq.push(["_trackPageview"])}if(B!==""){var G=n(E.url);G.hash=B;v.state.url=G.href;window.history.replaceState(v.state,E.title,G.href);var I=f(G.hash);if(I.length){f(window).scrollTop(I.offset().top)}}A("pjax:success",[H,F,J,x])};if(!v.state){v.state={id:k(),url:window.location.href,title:document.title,container:y.selector,fragment:x.fragment,timeout:x.timeout};window.history.replaceState(v.state,document.title)}var D=v.xhr;if(D&&D.readyState<4){D.onreadystatechange=f.noop;D.abort()}v.options=x;var D=v.xhr=f.ajax(x);if(D.readyState>0){if(x.push&&!x.replace){h(v.state.id,y.clone().contents());window.history.pushState(null,"",w(x.requestUrl))}A("pjax:start",[D,x]);A("pjax:send",[D,x])}return v.xhr}function s(x,y){var z={url:window.location.href,push:false,replace:true,scrollTo:false};return v(f.extend(z,q(x,y)))}function u(x){window.history.replaceState(null,"","#");window.location.replace(x)}function a(A){var B=A.state;if(B&&B.container){var x=f(B.container);if(x.length){var z=d[B.id];if(v.state){var C=v.state.id<B.id?"forward":"back";r(C,v.state.id,x.clone().contents())}var D=f.Event("pjax:popstate",{state:B,direction:C});x.trigger(D);var y={id:B.id,url:B.url,container:x,push:false,fragment:B.fragment,timeout:B.timeout,scrollTo:false};if(z){x.trigger("pjax:start",[null,y]);if(B.title){document.title=B.title}x.html(z);v.state=B;x.trigger("pjax:end",[null,y])}else{v(y)}x[0].offsetHeight}else{u(location.href)}}}function c(y){var x=f.isFunction(y.url)?y.url():y.url,B=y.type?y.type.toUpperCase():"GET";var z=f("<form>",{method:B==="GET"?"GET":"POST",action:x,style:"display:none"});if(B!=="GET"&&B!=="POST"){z.append(f("<input>",{type:"hidden",name:"_method",value:B.toLowerCase()}))}var A=y.data;if(typeof A==="string"){f.each(A.split("&"),function(C,D){var E=D.split("=");z.append(f("<input>",{type:"hidden",name:E[0],value:E[1]}))})}else{if(typeof A==="object"){for(key in A){z.append(f("<input>",{type:"hidden",name:key,value:A[key]}))}}}f(document.body).append(z);z.submit()}function k(){return(new Date).getTime()}function w(x){return x.replace(/\?_pjax=[^&]+&?/,"?").replace(/_pjax=[^&]+&?/,"").replace(/[\?&]$/,"")}function n(y){var x=document.createElement("a");x.href=y;return x}function q(x,y){if(x&&y){y.container=x}else{if(f.isPlainObject(x)){y=x}else{y={container:x}}}if(y.container){y.container=p(y.container)}return y}function p(x){x=f(x);if(!x.length){throw"no pjax container for "+x.selector}else{if(x.selector!==""&&x.context===document){return x}else{if(x.attr("id")){return f("#"+x.attr("id"))}else{throw"cant get selector for pjax container!"}}}}function l(y,x){return y.filter(x).add(y.find(x))}function t(A,C,y){var B={};B.url=w(C.getResponseHeader("X-PJAX-URL")||y.requestUrl);if(/<html/i.test(A)){var x=f(A.match(/<head[^>]*>([\s\S.]*)<\/head>/i)[0]);var z=f(A.match(/<body[^>]*>([\s\S.]*)<\/body>/i)[0])}else{var x=z=f(A)}if(z.length===0){return B}B.title=l(x,"title").last().text();if(y.fragment){if(y.fragment==="body"){var D=z}else{var D=l(z,y.fragment).first()}if(D.length){B.contents=D.contents();if(!B.title){B.title=D.attr("title")||D.data("title")}}}else{if(!/<html/i.test(A)){B.contents=z}}if(B.contents){B.contents=B.contents.not("title");B.contents.find("title").remove()}if(B.title){B.title=f.trim(B.title)}return B}var d={};var e=[];var g=[];function h(y,x){d[y]=x;g.push(y);while(e.length){delete d[e.shift()]}while(g.length>v.defaults.maxCacheLength){delete d[g.shift()]}}function r(z,B,y){var A,x;d[B]=y;if(z==="forward"){A=g;x=e}else{A=e;x=g}A.push(B);if(B=x.pop()){delete d[B]}}function m(){f.fn.pjax=i;f.pjax=v;f.pjax.enable=f.noop;f.pjax.disable=b;f.pjax.click=j;f.pjax.submit=o;f.pjax.reload=s;f.pjax.defaults={timeout:650,push:true,replace:false,type:"GET",dataType:"html",scrollTo:0,maxCacheLength:20};f(window).bind("popstate.pjax",a)}function b(){f.fn.pjax=function(){return this};f.pjax=c;f.pjax.enable=m;f.pjax.disable=f.noop;f.pjax.click=f.noop;f.pjax.submit=f.noop;f.pjax.reload=window.location.reload;f(window).unbind("popstate.pjax",a)}if(f.inArray("state",f.event.props)<0){f.event.props.push("state")}f.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]|WebApps\/.+CFNetwork)/);f.support.pjax?m():b()})(jQuery);